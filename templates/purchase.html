<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchase Cluster Prediction</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .container {
            max-width: 900px;
        }
        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .card {
            border-radius: 15px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            border: none;
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 20px rgba(0, 0, 0, 0.12);
        }
        .card-header {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-weight: bold;
            border-radius: 15px 15px 0 0 !important;
            padding: 15px 20px;
        }
        .form-label {
            font-weight: 500;
            margin-bottom: 0.3rem;
        }
        .form-control, .form-select {
            border-radius: 10px;
            padding: 10px 15px;
            border: 1px solid #ced4da;
        }
        .form-control:focus, .form-select:focus {
            box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.15);
            border-color: #2575fc;
        }
        .btn-primary {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            border: none;
            border-radius: 10px;
            padding: 10px 25px;
            font-weight: 500;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 12px rgba(37, 117, 252, 0.2);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(37, 117, 252, 0.3);
        }
        .result-card {
            background: linear-gradient(135deg, #8BC6EC 0%, #9599E2 100%);
            color: white;
            border-radius: 15px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .result-card:hover {
            transform: scale(1.02);
        }
        .result-value {
            font-size: 2.5rem;
            font-weight: bold;
        }
        .confidence-meter {
            height: 10px;
            border-radius: 5px;
            background-color: #e9ecef;
            margin-top: 8px;
        }
        .confidence-level {
            height: 100%;
            border-radius: 5px;
            background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%);
        }
        .nav-pills .nav-link {
            border-radius: 10px;
            margin-right: 10px;
            color: #495057;
        }
        .nav-pills .nav-link.active {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
        }
        .form-text {
            margin-top: 5px;
            color: #6c757d;
            font-size: 0.85rem;
        }
        .age-display {
            color: #2575fc;
            font-weight: 500;
        }
        .feature-input {
            transition: all 0.2s ease;
        }
        .feature-input:focus-within {
            transform: scale(1.02);
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <!-- Header -->
        <div class="header text-center mb-5">
            <h1 class="display-4"><i class="fas fa-chart-pie me-3"></i>Purchase Cluster Prediction</h1>
            <p class="lead">Predict which purchase cluster a customer belongs to based on their profile</p>
        </div>

        <!-- Navigation -->
        <ul class="nav nav-pills mb-4 justify-content-center">
            <li class="nav-item">
                <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/demographics">Demographics</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="/purchase">Purchase</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/spending">Spending</a>
            </li>
        </ul>

        <!-- Form Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-user-edit me-2"></i>Enter Customer Information</h5>
            </div>
            <div class="card-body">
                <form action="/predict_purchase" method="POST" id="purchaseForm">
                    <div class="row">
                        <!-- Demographics Section -->
                        <div class="col-md-6">
                            <h6 class="text-muted mb-3">Demographics</h6>

                            <div class="mb-3 feature-input">
                                <label for="year_birth" class="form-label">Year of Birth</label>
                                <input type="number" class="form-control" id="year_birth" name="Year_Birth" min="1920" max="2005" required>
                                <div class="form-text"></div>
                            </div>

                            <div class="mb-3 feature-input">
                                <label for="education" class="form-label">Education Level</label>
                                <select class="form-select" id="education" name="Education" required>
                                    <option value="" selected disabled>Select education level...</option>
                                    <option value="0">Basic</option>
                                    <option value="1">2n Cycle</option>
                                    <option value="2">Graduation</option>
                                    <option value="3">Master</option>
                                    <option value="4">PhD</option>
                                </select>
                            </div>

                            <div class="mb-3 feature-input">
                                <label for="marital_status" class="form-label">Marital Status</label>
                                <select class="form-select" id="marital_status" name="Marital_Status" required>
                                    <option value="" selected disabled>Select marital status...</option>
                                    <option value="Single">Single</option>
                                    <option value="Together">Together</option>
                                    <option value="Married">Married</option>
                                    <option value="Divorced">Divorced</option>
                                    <option value="Widow">Widow</option>
                                </select>
                            </div>
                        </div>

                        <!-- Household Section -->
                        <div class="col-md-6">
                            <h6 class="text-muted mb-3">Household Information</h6>

                            <div class="mb-3 feature-input">
                                <label for="income" class="form-label">Income (USD)</label>
                                <input type="number" class="form-control" id="income" name="Income" min="0" step="1000" required>
                                <div class="form-text"><i class="fas fa-info-circle"></i> Annual household income</div>
                            </div>

                            <div class="mb-3 feature-input">
                                <label for="kidhome" class="form-label">Number of Children at Home</label>
                                <input type="number" class="form-control" id="kidhome" name="Kidhome" min="0" max="5" required>
                                <div class="form-text"><i class="fas fa-info-circle"></i> Children under 13 years old</div>
                            </div>

                            <div class="mb-3 feature-input">
                                <label for="teenhome" class="form-label">Number of Teenagers at Home</label>
                                <input type="number" class="form-control" id="teenhome" name="Teenhome" min="0" max="5" required>
                                <div class="form-text"><i class="fas fa-info-circle"></i> Children 13-19 years old</div>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2 col-md-6 mx-auto mt-4">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-search me-2"></i>Predict Purchase Cluster
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Results Card (Initially Hidden) -->
        <div class="card result-card" id="resultCard" style="display: none;">
            <div class="card-body text-center py-4">
                <h4 class="mb-3">Prediction Result</h4>
                <div class="result-value mb-2" id="clusterResult">Cluster 0</div>
                <p class="mb-3" id="clusterDescription">This customer belongs to a high-value purchase cluster.</p>

                <div class="row align-items-center mt-4">
                    <div class="col-md-4 text-md-end">
                        <p class="mb-0">Prediction Confidence:</p>
                    </div>
                    <div class="col-md-6">
                        <div class="confidence-meter">
                            <div class="confidence-level" id="confidenceLevel" style="width: 85%"></div>
                        </div>
                    </div>
                    <div class="col-md-2 text-md-start">
                        <span id="confidenceValue">85%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Form submission handling
        document.getElementById('purchaseForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // In a real app, you would send the form data to the server
            // and get back a prediction result
            // For now, we'll just show a sample result
            document.getElementById('resultCard').style.display = 'block';
            document.getElementById('resultCard').scrollIntoView({ behavior: 'smooth' });

            // Sample prediction result (replace with actual server response in real implementation)
            const sampleCluster = Math.floor(Math.random() * 4);
            const sampleConfidence = Math.round(70 + Math.random() * 25);

            document.getElementById('clusterResult').textContent = `Cluster ${sampleCluster}`;
            document.getElementById('confidenceValue').textContent = `${sampleConfidence}%`;
            document.getElementById('confidenceLevel').style.width = `${sampleConfidence}%`;

            // Set description based on cluster
            const descriptions = [
                "Budget-conscious customers with moderate purchasing patterns.",
                "Regular shoppers with targeted category preferences.",
                "Premium buyers with high purchase frequency.",
                "Occasional big-ticket purchasers."
            ];
            document.getElementById('clusterDescription').textContent = descriptions[sampleCluster];
        });

        // Add animation effects to input fields
        document.querySelectorAll('.feature-input').forEach(item => {
            item.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.02)';
            });

            item.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        });

        // Auto-calculate age for display
        document.getElementById('year_birth').addEventListener('input', function() {
            const yearBirth = parseInt(this.value);
            const currentYear = new Date().getFullYear();
            const age = currentYear - yearBirth;

            if (!isNaN(age) && age > 0) {
                const helpText = this.nextElementSibling;
                helpText.innerHTML = `<i class="fas fa-info-circle"></i> Age: ${age} years old`;
                helpText.classList.add('age-display');
            }
        });
    </script>
</body>
</html>
